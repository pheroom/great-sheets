(()=>{var t={135:(t,e,n)=>{t.exports=n(248)},248:t=>{var e=function(t){"use strict";var e,n=Object.prototype,r=n.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",c=o.toStringTag||"@@toStringTag";function s(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(t){s=function(t,e,n){return t[e]=n}}function u(t,e,n,r){var o=e&&e.prototype instanceof y?e:y,i=Object.create(o.prototype),a=new E(r||[]);return i._invoke=function(t,e,n){var r=f;return function(o,i){if(r===h)throw new Error("Generator is already running");if(r===d){if("throw"===o)throw i;return C()}for(n.method=o,n.arg=i;;){var a=n.delegate;if(a){var c=P(a,n);if(c){if(c===v)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(r===f)throw r=d,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r=h;var s=l(t,e,n);if("normal"===s.type){if(r=n.done?d:p,s.arg===v)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(r=d,n.method="throw",n.arg=s.arg)}}}(t,n,a),i}function l(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}t.wrap=u;var f="suspendedStart",p="suspendedYield",h="executing",d="completed",v={};function y(){}function b(){}function g(){}var m={};s(m,i,(function(){return this}));var w=Object.getPrototypeOf,O=w&&w(w(D([])));O&&O!==n&&r.call(O,i)&&(m=O);var j=g.prototype=y.prototype=Object.create(m);function S(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function k(t,e){function n(o,i,a,c){var s=l(t[o],t,i);if("throw"!==s.type){var u=s.arg,f=u.value;return f&&"object"==typeof f&&r.call(f,"__await")?e.resolve(f.__await).then((function(t){n("next",t,a,c)}),(function(t){n("throw",t,a,c)})):e.resolve(f).then((function(t){u.value=t,a(u)}),(function(t){return n("throw",t,a,c)}))}c(s.arg)}var o;this._invoke=function(t,r){function i(){return new e((function(e,o){n(t,r,e,o)}))}return o=o?o.then(i,i):i()}}function P(t,n){var r=t.iterator[n.method];if(r===e){if(n.delegate=null,"throw"===n.method){if(t.iterator.return&&(n.method="return",n.arg=e,P(t,n),"throw"===n.method))return v;n.method="throw",n.arg=new TypeError("The iterator does not provide a 'throw' method")}return v}var o=l(r,t.iterator,n.arg);if("throw"===o.type)return n.method="throw",n.arg=o.arg,n.delegate=null,v;var i=o.arg;return i?i.done?(n[t.resultName]=i.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,v):i:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,v)}function _(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function x(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function E(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(_,this),this.reset(!0)}function D(t){if(t){var n=t[i];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,a=function n(){for(;++o<t.length;)if(r.call(t,o))return n.value=t[o],n.done=!1,n;return n.value=e,n.done=!0,n};return a.next=a}}return{next:C}}function C(){return{value:e,done:!0}}return b.prototype=g,s(j,"constructor",g),s(g,"constructor",b),b.displayName=s(g,c,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===b||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,g):(t.__proto__=g,s(t,c,"GeneratorFunction")),t.prototype=Object.create(j),t},t.awrap=function(t){return{__await:t}},S(k.prototype),s(k.prototype,a,(function(){return this})),t.AsyncIterator=k,t.async=function(e,n,r,o,i){void 0===i&&(i=Promise);var a=new k(u(e,n,r,o),i);return t.isGeneratorFunction(n)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},S(j),s(j,c,"Generator"),s(j,i,(function(){return this})),s(j,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=[];for(var n in t)e.push(n);return e.reverse(),function n(){for(;e.length;){var r=e.pop();if(r in t)return n.value=r,n.done=!1,n}return n.done=!0,n}},t.values=D,E.prototype={constructor:E,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(x),!t)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function o(r,o){return c.type="throw",c.arg=t,n.next=r,o&&(n.method="next",n.arg=e),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],c=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var s=r.call(a,"catchLoc"),u=r.call(a,"finallyLoc");if(s&&u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,v):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),x(n),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var o=r.arg;x(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={iterator:D(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=e),v}},t}(t.exports);try{regeneratorRuntime=e}catch(t){"object"==typeof globalThis?globalThis.regeneratorRuntime=e:Function("r","regeneratorRuntime = r")(e)}}},e={};function n(r){var o=e[r];if(void 0!==o)return o.exports;var i=e[r]={exports:{}};return t[r](i,i.exports,n),i.exports}n.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return n.d(e,{a:e}),e},n.d=(t,e)=>{for(var r in e)n.o(e,r)&&!n.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),(()=>{var t;n.g.importScripts&&(t=n.g.location+"");var e=n.g.document;if(!t&&e&&(e.currentScript&&(t=e.currentScript.src),!t)){var r=e.getElementsByTagName("script");r.length&&(t=r[r.length-1].src)}if(!t)throw new Error("Automatic publicPath is not supported in this browser");t=t.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),n.p=t})(),(()=>{"use strict";function t(t,e,n,r,o,i,a){try{var c=t[i](a),s=c.value}catch(t){return void n(t)}c.done?e(s):Promise.resolve(s).then(r,o)}function e(e){return function(){var n=this,r=arguments;return new Promise((function(o,i){var a=e.apply(n,r);function c(e){t(a,o,i,c,s,"next",e)}function s(e){t(a,o,i,c,s,"throw",e)}c(void 0)}))}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function i(t,e,n){return e&&o(t.prototype,e),n&&o(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}var a=n(135),c=n.n(a),s=function(){function t(e){r(this,t),this.$el="string"==typeof e?document.querySelector(e):e}return i(t,[{key:"html",value:function(t){return"string"==typeof t?(this.$el.innerHTML=t,this):this.$el.outerHTML.trim()}},{key:"text",value:function(t){return void 0!==t?(this.$el.textContent=t,this):"input"===this.$el.tagName.toLowerCase()?this.$el.value.trim():this.$el.textContent.trim()}},{key:"clear",value:function(){return this.html(""),this}},{key:"on",value:function(t,e){this.$el.addEventListener(t,e)}},{key:"off",value:function(t,e){this.$el.removeEventListener(t,e)}},{key:"find",value:function(t){return u(this.$el.querySelector(t))}},{key:"append",value:function(e){e instanceof t&&(e=e.$el),Element.prototype.append?this.$el.append(e):this.$el.appendChild(e)}},{key:"data",get:function(){return this.$el.dataset}},{key:"closest",value:function(t){return u(this.$el.closest(t))}},{key:"getCoords",value:function(){return this.$el.getBoundingClientRect()}},{key:"findAll",value:function(t){return this.$el.querySelectorAll(t)}},{key:"id",value:function(t){if(t){var e=this.id().split(":");return{row:+e[0],col:+e[1]}}return this.data.id}},{key:"focus",value:function(t){if(void 0===t)this.$el.firstChild.textContent=this.$el.firstChild.textContent.trim()||" ",this.$el.focus();else if(t)if(~t){if(1===t){var e=window.getSelection();e.setPosition(this.$el.firstChild,e.focusOffset+1<=this.$el.firstChild.textContent.length?e.focusOffset+1:this.$el.firstChild.textContent.length)}}else{var n=window.getSelection();n.setPosition(this.$el.firstChild,n.focusOffset-1>=0?n.focusOffset-1:0)}else{var r=window.getSelection();this.$el.firstChild.textContent=this.$el.firstChild.textContent.trim(),r.setPosition(this.$el.firstChild,this.$el.firstChild.textContent.length)}return this}},{key:"attr",value:function(t,e){return e?(this.$el.setAttribute(t,e),this):this.$el.getAttribute(t)}},{key:"css",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};for(var e in t)this.$el.style[e]=t[e]}},{key:"getStyles",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return e.reduce((function(e,n){return e[n]=t.$el.style[n],e}),{})}},{key:"addClass",value:function(t){return this.$el.classList.add(t),this}},{key:"removeClass",value:function(t){return this.$el.classList.remove(t),this}},{key:"toggle",value:function(t){return this.$el.classList.toggle(t),this}}]),t}();function u(t){return new s(t)}u.create=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=document.createElement(t);return e&&n.classList.add(e),u(n)};var l=function(){function t(){r(this,t)}return i(t,null,[{key:"path",get:function(){return window.location.hash.slice(1)}},{key:"param",get:function(){return t.path.split("/")[1]}},{key:"navigate",value:function(t){window.location.hash=t}}]),t}();function f(){return u.create("div","loader").html('\n        <div class="lds-ring">\n            <div></div>\n            <div></div>\n            <div></div>\n            <div></div>\n        </div>\n  ')}var p=function(){function t(e,n){r(this,t),this.$placeholder=u(e),this.routes=n,this.loader=new f,this.page=null,this.changePageHandler=this.changePageHandler.bind(this),this.init()}var n;return i(t,[{key:"init",value:function(){window.addEventListener("hashchange",this.changePageHandler),this.changePageHandler()}},{key:"changePageHandler",value:(n=e(c().mark((function t(){var e,n;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.page&&this.page.destroy(),this.$placeholder.clear().append(this.loader),e=l.path.includes("excel")?this.routes.excel:this.routes.dashboard,this.page=new e(l.param),t.next=6,this.page.getRoot();case 6:n=t.sent,this.$placeholder.clear().append(n),this.page.afterRender();case 9:case"end":return t.stop()}}),t,this)}))),function(){return n.apply(this,arguments)})},{key:"destroy",value:function(){window.removeEventListener("hashchange",this.changePageHandler)}}]),t}();function h(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function d(t,e){return d=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},d(t,e)}function v(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&d(t,e)}function y(t){return y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},y(t)}function b(t,e){if(e&&("object"===y(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function g(t){return g=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},g(t)}var m=function(){function t(e){r(this,t),this.params=e||Date.now().toString()}return i(t,[{key:"getRoot",value:function(){throw new Error('Method "getRoot" should be implemented')}},{key:"afterRender",value:function(){}},{key:"destroy",value:function(){}}]),t}();function w(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function O(t,e){if(t){if("string"==typeof t)return w(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?w(t,e):void 0}}function j(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,i=[],a=!0,c=!1;try{for(n=n.call(t);!(a=(r=n.next()).done)&&(i.push(r.value),!e||i.length!==e);a=!0);}catch(t){c=!0,o=t}finally{try{a||null==n.return||n.return()}finally{if(c)throw o}}return i}}(t,e)||O(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var S={textAlign:"left",fontWeight:"normal",textDecoration:"none",fontStyle:"normal",color:"#000000",background:"#FFFFFF"},k="New table";function P(t,e){if(t>e){var n=[e,t];t=n[0],e=n[1]}return new Array(e-t+1).fill("").map((function(e,n){return t+n}))}function _(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!e)return JSON.parse(localStorage.getItem(t));localStorage.setItem(t,JSON.stringify(e))}function x(t){return t.replace(/([A-Z])/g,(function(t){return"-".concat(t[0].toLowerCase())}))}function E(t,e){var n;return function(){for(var r=this,o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];var c=function(){clearTimeout(n),t.apply(r,i)};clearTimeout(n),n=setTimeout(c,e)}}function D(t){var e=Object.entries(t).sort((function(t,e){return e[1].openedDate-t[1].openedDate}));return e.length?'\n        <div class="db__list-header">\n            <span>Название</span>\n            <span>По дате просмотра</span>\n        </div>\n        <ul class="db__list">\n            '.concat(e.map((function(t){var e=j(t,2),n=e[0],r=e[1];return function(t,e){return'\n        <li>\n            <a class="db__record" href="#excel/'.concat(t,'">\n                <span>').concat(e.title,"</span>\n                <srtong>").concat(new Date(e.openedDate).toLocaleDateString(),"</srtong>\n            </a>\n        </li>\n    ")}(n.split(":")[1],r)})).join(""),"\n        </ul>\n    "):"<p>No table yet</p>"}const C=n.p+"68bff53c5b17d7dc9edade36821d9ba5.png";var $=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:300;r(this,t),this.client=e,this.listen=E(this.listen.bind(this),n)}return i(t,[{key:"listen",value:function(t){this.client.save(t)}},{key:"save",value:function(){var t;return(t=this.client).save.apply(t,arguments)}},{key:"get",value:function(){return this.client.get()}},{key:"getAll",value:function(){return this.client.getAll()}}]),t}();function R(t){return"excel:".concat(t)}var L=function(){function t(e){r(this,t),this.name=R(e)}return i(t,[{key:"save",value:function(t,e){return _(e?R(e):this.name,t),Promise.resolve()}},{key:"get",value:function(){return Promise.resolve(_(this.name))}},{key:"getAll",value:function(){for(var t={},e=0;e<localStorage.length;e++){var n=localStorage.key(e);if(n.includes("excel")){var r=_(n);t[n]={openedDate:r.openedDate,title:r.title}}}return Promise.resolve(t)}}]),t}();function A(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function T(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?A(Object(n),!0).forEach((function(e){h(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):A(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var N={title:k,rowState:{},rowsCount:100,colState:{},dataState:{},stylesState:{},currentText:"",currentStyles:S,openedDate:(new Date).toJSON()};function I(t){return t?function(t){return T(T({},t),{},{currentStyles:S,currentText:""})}(t):(e=N,JSON.parse(JSON.stringify(e)));var e}function B(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function F(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?B(Object(n),!0).forEach((function(e){h(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):B(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var H=function(t){v(f,t);var n,o,a,s=(o=f,a=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=g(o);if(a){var n=g(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return b(this,t)});function f(t){var e;return r(this,f),(e=s.call(this,t)).processor=new $(new L(e.params)),e.handleInputFile=function(t){if("import-csv"===t.target.dataset.input){var n=Date.now();(r=t.target.files[0],new Promise((function(t){var e=new FileReader;e.onload=function(n){for(var r={},o=e.result.split("\n"),i=0;i<o.length;i++)for(var a=o[i].split(","),c=0;c<a.length;c++){for(var s=a[c];s.includes('"');)s=s.replace('"',"");(s=s.trim())&&(r["".concat(i,":").concat(c)]=s)}t(r)},e.readAsText(r)}))).then((function(r){e.processor.save(F(F({},N),{},{title:t.target.files[0].name,dataState:r}),n).then((function(){return l.navigate("excel/"+n)}))}))}var r},e}return i(f,[{key:"getRoot",value:(n=e(c().mark((function t(){var e;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=Date.now().toString(),document.addEventListener("input",this.handleInputFile),t.t0=u.create("div","db"),t.t1='\n            <div class="db__header">\n                <img class="db__logo" src='.concat(C,' alt="logo">\n                <h1>Great Sheets</h1>\n            </div>\n            <div class="db__new">\n                <div class="db__view db__new-inner">\n                    <a href="#excel/').concat(e,'" class="db__create">\n                        new <br/> table\n                    </a>\n                    <label class="db__input-file">\n                        <input data-input="import-csv" type="file" name="csv" accept=".csv">\n                        <span>Загрузить файл</span>\n                    </label>\n                </div>\n            </div>\n            <div class="db__table db__view">\n                '),t.t2=D,t.next=7,this.processor.getAll();case 7:return t.t3=t.sent,t.t4=(0,t.t2)(t.t3),t.t5=t.t1.concat.call(t.t1,t.t4,"\n            </div>\n        "),t.abrupt("return",t.t0.html.call(t.t0,t.t5));case 11:case"end":return t.stop()}}),t,this)}))),function(){return n.apply(this,arguments)})},{key:"destroy",value:function(){document.removeEventListener("input",this.handleInputFile)}}]),f}(m);function J(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function M(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?J(Object(n),!0).forEach((function(e){h(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):J(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function G(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t(M({},e),{type:"__INIT__"}),r=[];return{subscribe:function(t){return r.push(t),{unsubscribe:function(){r=r.filter((function(e){return e!==t}))}}},dispatch:function(e){n=t(n,e),r.forEach((function(t){return t(n)}))},getState:function(){return JSON.parse(JSON.stringify(n))}}}var z="TABLE_RESIZE",U="CHANGE_TEXT",W="CHANGE_STYLE",K="APPLY_STYLE",Y="CHANGE_TITLE",q="UPDATE_DATE",X="CHANGE_ROW_COUNT";function Z(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function Q(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Z(Object(n),!0).forEach((function(e){h(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Z(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function V(t,e){var n,r,o;switch(e.type){case z:return r="col"===e.data.type?"colState":"rowState",Q(Q({},t),{},h({},r,tt(t,r,e)));case X:return Q(Q({},t),{},{rowsCount:t.rowsCount+ +e.data});case U:return r="dataState",Q(Q({},t),{},h({currentText:e.data.value},r,tt(t,r,e)));case W:return Q(Q({},t),{},{currentStyles:e.data});case K:return o=t[r="stylesState"]||{},e.data.ids.forEach((function(t){o[t]=Q(Q({},o[t]),e.data.value)})),Q(Q({},t),{},(h(n={},r,o),h(n,"currentStyles",Q(Q({},t.currentStyles),e.data.value)),n));case Y:return Q(Q({},t),{},{title:e.data});case q:return Q(Q({},t),{},{openedDate:Date.now()});default:return t}}function tt(t,e,n){var r=t[e]||{};return r[n.data.id]=n.data.value,r}var et=function(){function t(){r(this,t),this.listeners={}}return i(t,[{key:"emit",value:function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return!!Array.isArray(this.listeners[t])&&(this.listeners[t].forEach((function(t){t.apply(void 0,n)})),!0)}},{key:"subscribe",value:function(t,e){var n=this;return this.listeners[t]=this.listeners[t]||[],this.listeners[t].push(e),function(){n.listeners[t]=n.listeners[t].filter((function(t){return t!==e}))}}}]),t}(),nt=function(){function t(e){r(this,t),this.store=e,this.sub=null,this.prevState={}}return i(t,[{key:"subscribeComponents",value:function(t){var e=this;this.prevState=this.store.getState(),this.sub=this.store.subscribe((function(n){Object.keys(n).forEach((function(r){var o,i;o=e.prevState[r],i=n[r],("object"===y(o)&&"object"===y(i)?JSON.stringify(o)===JSON.stringify(i):o===i)||t.forEach((function(t){if(t.isWatching(r)){var e=h({},r,n[r]);t.storeChanged(e)}}))})),e.prevState=e.store.getState()}))}},{key:"unsubscribeFromStore",value:function(){this.sub.unsubscribe()}}]),t}();function rt(t){return{type:z,data:t}}var ot=function(){function t(e){r(this,t),this.components=e.components||[],this.store=e.store,this.emitter=new et,this.subscriber=new nt(this.store)}return i(t,[{key:"getRoot",value:function(){var t=u.create("div","excel"),e={emitter:this.emitter,store:this.store};return this.components=this.components.map((function(n){var r=u.create("div",n.className),o=new n(r,e);return o.name&&(window["c".concat(o.name)]=o),r.html(o.toHTML()),t.append(r),o})),t}},{key:"init",value:function(){this.store.dispatch({type:q}),this.subscriber.subscribeComponents(this.components),this.components.forEach((function(t){return t.init()}))}},{key:"destroy",value:function(){this.subscriber.unsubscribeFromStore(),this.components.forEach((function(t){return t.destroy()}))}}]),t}();function it(t){return"on".concat("string"!=typeof(e=t)?"":e.charAt(0).toUpperCase()+e.slice(1));var e}var at=function(t){v(a,t);var e,n,o=(e=a,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,r=g(e);if(n){var o=g(this).constructor;t=Reflect.construct(r,arguments,o)}else t=r.apply(this,arguments);return b(this,t)});function a(t){var e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return r(this,a),(e=o.call(this,t,n.listeners)).name=n.name||"",e.emitter=n.emitter,e.subscribe=n.subscribe||[],e.store=n.store,e.unsubscribers=[],e.prepare(),e}return i(a,[{key:"prepare",value:function(){}},{key:"toHTML",value:function(){return""}},{key:"$emit",value:function(t){for(var e,n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];(e=this.emitter).emit.apply(e,[t].concat(r))}},{key:"$on",value:function(t,e){var n=this.emitter.subscribe(t,e);this.unsubscribers.push(n)}},{key:"$dispatch",value:function(t){this.store.dispatch(t)}},{key:"storeChanged",value:function(){}},{key:"isWatching",value:function(t){return this.subscribe.includes(t)}},{key:"init",value:function(){this.initDOMListeners()}},{key:"destroy",value:function(){this.removeDOMListeners(),this.unsubscribers.forEach((function(t){return t()}))}}]),a}(function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(r(this,t),!e)throw new Error("No $root provided fot DomListener!");this.$root=e,this.listeners=n}return i(t,[{key:"initDOMListeners",value:function(){var t=this;this.listeners.forEach((function(e){var n=it(e);if(!t[n])throw new Error("'".concat(t.name,"' haven't ").concat(n));t[n]=t[n].bind(t),t.$root.on(e,t[n])}))}},{key:"removeDOMListeners",value:function(){var t=this;this.listeners.forEach((function(e){var n=it(e);t.$root.off(e,t[n])}))}}]),t}());const ct=n.p+"1f872c40a0179f67c07c9e71f6a27d02.png",st=n.p+"ee4b58337bd3477db466a4c4309cc104.png";function ut(t){return"\n        <button ".concat(t.meta,' class="button-icon ').concat(t.active?"button-icon--active ":"",'" >\n            <img \n                ').concat(t.meta,"\n                class='button-icon__icon' \n                src=").concat(t.img," \n                alt=").concat(t.alt,"/>\n        </button>\n    ")}function lt(t){return"\n        <label for=\"fill-color\" class='color-input__label'>\n            <img class='color-input__label-img' src=".concat(t.img," alt=").concat(t.alt,'/>\n        </label>\n        <input \n            class=\'color-input__input\'\n            type="color"\n            id="fill-color"\n            data-field=').concat(t.field,'\n            data-type="color-input"\n            value=').concat("#"===t.value[0]?t.value:"#"+t.value.split("").map((function(t){return"0123456789,".includes(t)?t:""})).join("").split(",").map((function(t){return+t})).map((function(t){var e=t.toString(16);return 1===e.length?"0"+e:e})).join("")," />\n    ")}function ft(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}var pt=function(t){v(a,t);var e,n,o=(e=a,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,r=g(e);if(n){var o=g(this).constructor;t=Reflect.construct(r,arguments,o)}else t=r.apply(this,arguments);return b(this,t)});function a(t,e){return r(this,a),o.call(this,t,function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?ft(Object(n),!0).forEach((function(e){h(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ft(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({name:"Header",listeners:["input","click"]},e))}return i(a,[{key:"toHTML",value:function(){var t=this.store.getState().title||k;return"\n            ".concat(ut({meta:'data-button="exit"',img:C,alt:"main"}),'\n            <input spellcheck="false" type="text" class="input header__input" value="').concat(t,'"/>\n            <div class="header__actions">\n                ').concat(ut({meta:'data-button="export-csv"',img:ct,alt:"download"}),"\n                ").concat(ut({meta:'data-button="remove"',img:st,alt:"remove"}),"\n            </div>    \n    ")}},{key:"onClick",value:function(t){var e,n,r,o=u(t.target);if("remove"===o.data.button)confirm("Do you really want to delete this table?")&&(localStorage.removeItem("excel:".concat(l.param)),l.navigate(""));else if("exit"===o.data.button)l.navigate("");else if("export-csv"===o.data.button){var i=this.store.getState();e=function(t){var e=Array(t.rowsCount).fill().map((function(){return Array(26).fill("")}));Object.entries(t.dataState).forEach((function(t){var n=j(t,2),r=n[0],o=n[1],i=j(r.split(":").map((function(t){return+t})),2),a=i[0],c=i[1];e[a][c]=o}));var n,r=new Blob([(n=e,n.map((function(t){return t.map(String).map((function(t){return t.replaceAll('"','""')})).map((function(t){return'"'.concat(t,'"')})).join(",")})).join("\r\n"))],{type:"text/csv;charset=utf-8;"});return URL.createObjectURL(r)}(i),n="".concat(i.title||k,".csv"),(r=document.createElement("a")).href=e,r.download=n,document.body.appendChild(r),r.click(),document.body.removeChild(r)}}},{key:"onInput",value:function(t){var e,n=u(t.target);this.$dispatch((e=n.text(),{type:Y,data:e}))}}]),a}(at);h(pt,"className","header");const ht=n.p+"b99cf2be3d24924daffae61336441c96.png",dt=n.p+"e5f97a5779612f3a88c6c5ac3996527b.png",vt=n.p+"3569c30c915eb547e0f5921510693748.png",yt=n.p+"19254c806ad390affa94e56dee587b46.png",bt=n.p+"aaebd9db55a99579644e3e6b53c3f9a8.png",gt=n.p+"f77d127f69d4ab180be0ab9319d7ca2b.png",mt=n.p+"d7fc7c7cfcc5963110998955d49d707a.png",wt=n.p+"27501e68b92752e7e138d7dabf09047a.png";function Ot(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function jt(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Ot(Object(n),!0).forEach((function(e){h(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Ot(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function St(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}var kt=function(t){v(a,t);var e,n,o=(e=a,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,r=g(e);if(n){var o=g(this).constructor;t=Reflect.construct(r,arguments,o)}else t=r.apply(this,arguments);return b(this,t)});function a(t,e){return r(this,a),o.call(this,t,function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?St(Object(n),!0).forEach((function(e){h(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):St(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({name:"Toolbar",listeners:["click","change"],subscribe:["currentStyles"]},e))}return i(a,[{key:"prepare",value:function(){this.initState(S)}},{key:"template",get:function(){return t=this.state,e=[{meta:'data-type="button" data-value=\''.concat(JSON.stringify({textAlign:"left"}),"'"),icon:"format_align_left",img:dt,alt:"left",active:"left"===t.textAlign},{meta:'data-type="button" data-value=\''.concat(JSON.stringify({textAlign:"center"}),"'"),icon:"format_align_center",img:ht,alt:"center",active:"center"===t.textAlign},{meta:'data-type="button" data-value=\''.concat(JSON.stringify({textAlign:"right"}),"'"),icon:"format_align_right",img:vt,alt:"right",active:"right"===t.textAlign},{meta:'data-type="button" data-value=\''.concat(JSON.stringify({fontWeight:"bold"===t.fontWeight?"normal":"bold"}),"'"),icon:"format_bold",img:yt,alt:"bold",active:"bold"===t.fontWeight},{meta:'data-type="button" data-value=\''.concat(JSON.stringify({textDecoration:"underline"===t.textDecoration?"none":"underline"}),"'"),icon:"format_underlined",img:bt,alt:"underline",active:"underline"===t.textDecoration},{meta:'data-type="button" data-value=\''.concat(JSON.stringify({fontStyle:"italic"===t.fontStyle?"normal":"italic"}),"'"),icon:"format_italic",img:gt,alt:"italic",active:"italic"===t.fontStyle}],n=[{img:mt,alt:"fill",field:"background",value:t.background},{img:wt,alt:"stroke",field:"color",value:t.color}],[].concat(e.map(ut),n.map(lt)).join("");var t,e,n}},{key:"toHTML",value:function(){return this.template}},{key:"storeChanged",value:function(t){this.setState(t.currentStyles)}},{key:"onClick",value:function(t){var e=u(t.target);if("button"===e.data.type){var n=JSON.parse(e.data.value);this.$emit("toolbar:applyStyle",n)}}},{key:"onChange",value:function(t){var e=u(t.target);if("color-input"===e.data.type){var n=t.target.value;this.$emit("toolbar:applyStyle",h({},e.data.field,n))}}}]),a}(function(t){v(a,t);var e,n,o=(e=a,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,r=g(e);if(n){var o=g(this).constructor;t=Reflect.construct(r,arguments,o)}else t=r.apply(this,arguments);return b(this,t)});function a(){r(this,a);for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return o.call.apply(o,[this].concat(e))}return i(a,[{key:"template",get:function(){return JSON.stringify(this.state)}},{key:"initState",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.state=jt({},t)}},{key:"setState",value:function(t){this.state=jt(jt({},this.state),t),this.$root.html(this.template)}}]),a}(at));function Pt(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=g(t)););return t}function _t(){return _t="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=Pt(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},_t.apply(this,arguments)}h(kt,"className","toolbar");const xt=n.p+"d2541db8e66f372fe16e7da80a15d797.png";function Et(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}var Dt=function(t){v(a,t);var e,n,o=(e=a,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,r=g(e);if(n){var o=g(this).constructor;t=Reflect.construct(r,arguments,o)}else t=r.apply(this,arguments);return b(this,t)});function a(t,e){return r(this,a),o.call(this,t,function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Et(Object(n),!0).forEach((function(e){h(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Et(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({name:"Formula",listeners:["input","keydown"],subscribe:["currentText"]},e))}return i(a,[{key:"toHTML",value:function(){return'\n            <div class="formula__info">\n                <img class="formula__icon" src='.concat(xt,' alt="formula">\n            </div>\n            <div id="formula" class="formula__input" contenteditable spellcheck="false"></div>\n        ')}},{key:"init",value:function(){var t=this;_t(g(a.prototype),"init",this).call(this),this.$formula=this.$root.find("#formula"),this.$on("table:select",(function(e){t.$formula.text(e.data.value||"")}))}},{key:"storeChanged",value:function(t){this.$formula.text(t.currentText)}},{key:"onInput",value:function(t){this.$emit("formula:input",u(t.target).text())}},{key:"onKeydown",value:function(t){["Enter","Tab"].includes(t.key)&&(t.preventDefault(),this.$emit("formula:done"))}}]),a}(at);function Ct(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";if(t.startsWith("="))try{return t.slice(1)}catch(e){return t}return t}function $t(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function Rt(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?$t(Object(n),!0).forEach((function(e){h(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):$t(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}h(Dt,"className","formula");function Lt(t,e){return(t[e]||120)+"px"}function At(t,e){return function(n,r){var o=Lt(t.colState,r),i="".concat(e,":").concat(r),a=t.dataState[i],c=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object.keys(t).map((function(e){return"".concat(x(e),": ").concat(t[e])})).join(";")}(Rt(Rt({},S),t.stylesState[i]));return'\n            <div \n                class="table__row-data-cell" \n                contenteditable \n                data-type="cell"\n                data-id="'.concat(e,":").concat(r,'"\n                data-col="').concat(r,'"\n                data-value="').concat(a||"",'"\n                style="').concat(c,"; width: ").concat(o,'"\n                spellcheck="false"\n            >\n                ').concat(Ct(a)||"","  \n            </div>\n        ")}}function Tt(t){var e=t.col,n=t.index,r=t.width;return'\n        <div \n            class="table__row-data-column" \n            data-type="resizable" \n            data-col="'.concat(n,'"\n            style="width: ').concat(r,'" \n        >\n            ').concat(e,"\n            <div class='table__col-resize' data-resize='col'></div>\n        </div>\n    ")}function Nt(t,e,n){var r=t?"<div class='table__row-resize' data-resize='row'></div>":"",o=function(t,e){return(t[e]||24)+"px"}(n,t);return'\n        <div \n            class="table__row" \n            data-type="resizable" \n            data-row="'.concat(t,'"\n            style="height: ').concat(o,'"\n        > \n            <div class="table__row-info">\n                ').concat(t,"\n                ").concat(r,'\n            </div>\n            <div class="table__row-data">\n                ').concat(e,"\n            </div>\n        </div>\n    ")}function It(t,e){return String.fromCharCode(65+e)}function Bt(t,e){return new Promise((function(n){var r,o=u(e.target),i=o.closest('[data-type="resizable"]'),a=i.getCoords(),c=e.target.dataset.resize,s="col"===c?"bottom":"right";o.css(h({opacity:1},s,"-5000px")),document.onmousemove=function(t){if("col"===c){var e=t.pageX-a.right;r=a.width+e,o.css({right:-e+"px"})}else{var n=t.pageY-a.bottom;r=a.height+n,o.css({bottom:-n+"px"})}},document.onmouseup=function(){document.onmousemove=null,document.onmouseup=null,"col"===c?t.findAll('[data-col="'.concat(i.data.col,'"]')).forEach((function(t){return t.style.width=r+"px"})):i.css({height:r+"px"}),n({value:r,id:i.data[c],type:c}),o.css({opacity:0,right:0,bottom:0})}}))}function Ft(t){return function(t){if(Array.isArray(t))return w(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||O(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var Ht=function(){function t(){r(this,t),this.group=[],this.current=null}return i(t,[{key:"select",value:function(e){this.clear(),this.group.push(e),this.current=e,e.focus(0).addClass(t.className)}},{key:"clear",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.group.forEach((function(n){e||n.removeClass(t.className),n.removeClass(t.classTop),n.removeClass(t.classBottom),n.removeClass(t.classLeft),n.removeClass(t.classRight),n.removeClass(t.classFill)})),this.group=[]}},{key:"selectedIds",get:function(){return this.group.map((function(t){return t.id()}))}},{key:"selectGroup",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[[]];this.clear(!0);var n=e.length,r=e[0].length;e[0].forEach((function(e,n){0===n&&e.addClass(t.classLeft),n===r-1&&e.addClass(t.classRight),e.addClass(t.classTop)})),e[n-1].forEach((function(e,n){0===n&&e.addClass(t.classLeft),n===r-1&&e.addClass(t.classRight),e.addClass(t.classBottom)}));for(var o=1;o<n-1;o++)e[o][0].addClass(t.classLeft),e[o][r-1].addClass(t.classRight);this.group=e.reduce((function(t,e){return[].concat(Ft(e),Ft(t))}),[]),this.group.forEach((function(e){return e.addClass(t.classFill)})),this.current.focus()}},{key:"applyStyle",value:function(t){this.group.forEach((function(e){return e.css(t)}))}}]),t}();function Jt(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}h(Ht,"className","table__row-data-cell--selected"),h(Ht,"classLeft","table__row-data-cell--selected-left"),h(Ht,"classRight","table__row-data-cell--selected-right"),h(Ht,"classTop","table__row-data-cell--selected-top"),h(Ht,"classBottom","table__row-data-cell--selected-bottom"),h(Ht,"classFill","table__row-data-cell--selected-fill");var Mt=function(t){v(l,t);var n,o,a,s=(o=l,a=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=g(o);if(a){var n=g(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return b(this,t)});function l(t,e){return r(this,l),s.call(this,t,function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Jt(Object(n),!0).forEach((function(e){h(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Jt(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({name:"Table",listeners:["mousedown","keydown","input"]},e))}return i(l,[{key:"toHTML",value:function(){return function(t){var e=t.rowsCount,n=[],r=new Array(26).fill("").map(It).map(function(t){return function(e,n){return{col:e,index:n,width:Lt(t.colState,n)}}}(t)).map(Tt).join("");n.push(Nt("",r,{}));for(var o=0;o<e;o++){var i=new Array(26).fill("").map(At(t,o)).join("");n.push(Nt(o+1,i,t.rowState))}return n.join("")}(this.store.getState())+'<div class="add-rows-form">\n                <input data-type="input-add-rows" id="input-add-rows" class="input add-rows-form__input" type="number" value="10"/> \n                <button class="add-rows-form__button" data-type="button-add-rows">Добавить</button>\n                <i class="add-rows-form__i">Изменения применятся после обновления страницы!</i>\n           </div>'}},{key:"prepare",value:function(){this.selection=new Ht}},{key:"init",value:function(){var t=this;_t(g(l.prototype),"init",this).call(this);var e=this.$root.find('[data-id="0:0"]');this.selectCell(e),this.$on("formula:input",(function(e){t.selection.current.attr("data-value",e).text(Ct(e)),t.updateTextInStore(e)})),this.$on("formula:done",(function(){t.selection.current.focus(0)})),this.$on("toolbar:applyStyle",(function(e){var n;t.selection.applyStyle(e),t.$dispatch((n={value:e,ids:t.selection.selectedIds},{type:K,data:n}))}))}},{key:"selectCell",value:function(t){this.selection.select(t),this.$emit("table:select",t);var e=t.getStyles(Object.keys(S));this.$dispatch({type:W,data:e})}},{key:"resizeTable",value:(n=e(c().mark((function t(e){var n;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Bt(this.$root,e);case 2:n=t.sent,this.$dispatch(rt(n));case 4:case"end":return t.stop()}}),t,this)}))),function(t){return n.apply(this,arguments)})},{key:"onMousedown",value:function(t){var e,n=this;if(function(t){return"button-add-rows"===t.target.dataset.type}(t)){var r=(e=document.getElementById("input-add-rows").value)>0?e:10;this.$dispatch({type:X,data:r})}else if(function(t){return t.target.dataset.resize}(t))this.resizeTable(t);else if(function(t){return"cell"===t.target.dataset.type}(t)){var o=u(t.target);if(this.$emit("table:select",o),t.shiftKey){t.preventDefault();var i=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=t.id(!0),o=e.id(!0),i=P(o.col,r.col),a=P(o.row,r.row);return n?a.reduce((function(t,e){var n=[];return i.forEach((function(t){return n.push("".concat(e,":").concat(t))})),[].concat(Ft(t),[n])}),[]):i.reduce((function(t,e){return a.forEach((function(n){return t.push("".concat(n,":").concat(e))})),t}),[])}(o,this.selection.current,!0).map((function(t){return t.map((function(t){return n.$root.find('[data-id="'.concat(t,'"]'))}))}));this.selection.selectGroup(i)}else this.selectCell(o)}}},{key:"onKeydown",value:function(t){var e=t.key;if("Enter"===e&&t.shiftKey)t.preventDefault();else if(!["Enter","Tab","ArrowLeft","ArrowRight","ArrowDown","ArrowUp"].includes(e)||t.shiftKey||t.ctrlKey)["ArrowLeft","ArrowRight"].includes(e)&&t.ctrlKey&&(t.preventDefault(),this.selection.current.focus("ArrowRight"===e?1:-1));else{t.preventDefault();var n=this.selection.current.id(!0),r=this.$root.find(function(t,e,n){var r=e.col,o=e.row,i=n-1;switch(t){case"Enter":case"ArrowDown":o=o+1>i?i:o+1;break;case"Tab":case"ArrowRight":r=r+1>25?25:r+1;break;case"ArrowLeft":r=r-1<0?0:r-1;break;case"ArrowUp":o=o-1<0?0:o-1}return'[data-id="'.concat(o,":").concat(r,'"]')}(e,n,this.store.getState().rowsCount));this.selectCell(r)}}},{key:"updateTextInStore",value:function(t){var e;this.$dispatch((e={id:this.selection.current.id(),value:t},{type:U,data:e}))}},{key:"onInput",value:function(t){var e=u(t.target);if("input-add-rows"!==e.data.type){var n=e.text();e.data.value=n,this.updateTextInStore(n)}}}]),l}(at);h(Mt,"className","table"),new p("#app",{dashboard:H,excel:function(t){v(u,t);var n,o,a,s=(o=u,a=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=g(o);if(a){var n=g(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return b(this,t)});function u(t){var e;return r(this,u),(e=s.call(this,t)).storeSub=null,e.processor=new $(new L(e.params)),e}return i(u,[{key:"getRoot",value:(n=e(c().mark((function t(){var e,n;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.processor.get();case 2:return e=t.sent,n=G(V,I(e)),this.storeSub=n.subscribe(this.processor.listen),this.excel=new ot({components:[pt,kt,Dt,Mt],store:n}),t.abrupt("return",this.excel.getRoot());case 7:case"end":return t.stop()}}),t,this)}))),function(){return n.apply(this,arguments)})},{key:"afterRender",value:function(){this.excel.init()}},{key:"destroy",value:function(){this.excel.destroy(),this.storeSub.unsubscribe()}}]),u}(m)})})()})();